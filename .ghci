:set -fwarn-incomplete-patterns
:set -fwarn-unused-binds -fwarn-unused-imports
:set -isrc
:load exe/Main.hs

let testList = ["Anonymous", "Butter-fly", "Typhoon", "Nagori-yuki", "Natsu-yuuzora", "Nada-sousou", "Yuki-no-hana"]

let buildTestEx j r t = unwords [":main", "-j", j, "-r", r, "-o", t]
let buildTest test    = buildTestEx ("tests/" ++ test ++ "/" ++ test ++ ".j") ("tests/" ++ test ++ "/" ++ test ++ ".r") (test ++ ".tex")
let buildXeLatex test = unwords [":!xelatex", test ++ ".tex"]

:{
:def test \cmd -> return $ unlines $ case cmd of
        []    -> map buildTest testList
        index -> [buildTest (testList !! ((read index :: Int) - 1))]
:}

:{
:def xelatex \cmd -> return $ unlines $ case cmd of
        []    -> map buildXeLatex testList
        index -> [buildXeLatex (testList !! ((read index :: Int) - 1))]
:}
